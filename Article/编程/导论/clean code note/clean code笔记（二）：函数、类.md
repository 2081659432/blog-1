#clean code笔记（二）：函数、类
## 编写函数的规范
> 沃德原则:_如果每个历程都让你感到深和己意，那就是整洁的代码_

### 基本规范（重要）
- (最为重要的一点)函数体尽可能**短小**尽可能**短小**
- 一个函数只做**一件事**，并做好这件事。要判断函数是否只做了一件事，有一个办法是看在你编的函数里，你能否再拆出一个函数
- 函数的数量也不应该太多。
- 注意要将switch埋藏在较低的抽象层级。

### 函数参数
- 参数名，最好**和函数名有联系**。这样可以，大大减轻记忆参数的负担
- **禁止把布尔值传入函数**。
  - 因为这样做，意味着，**宣称本函数不只做一件事**：ture时做一件事，false时则在做另外一件事。

- **函数参数的个数尽可能少**！**最理想的参数数量是零**。
  - 这个规则，使得用函数更简单。
  - 还使得测试函数得到了方便，因为输入的参数少了，困难麻烦就少了。

- 函数参数尽量是**单个值的有序组成部份，或者多个有序的值，有序性是很重要的**。
  - 如果函数参数之间无序，你无法很快知道某个参数的作用。

- 如果函数的参数有多个的话，可能需要将参数**封装成对象**，重要。
- 应该**避免使用输出参数**（重要，后面的grade即是输出参数）。
  - 当某个函数必须要修改某个变量的时候，还不如修改所属对象的状态。这样以来我们可以通过对象来分析参数的意义，而仅仅通过某个变量所获取的会不足。比如changeGrade（grade）来调用显然没有student.changeGrade()舒服，这样也就是在用**对象自身的方法来改变对象本身**。

### 函数的抽象层（重点，也称作粒度）
- 函数的抽象层级以**功能**来划分，比如去买书，抽象层级：买书>去书店>走路
- 函数的抽象层级的**最高层类似于人类自然语言**，使代码清晰易懂，简洁。
- **确保每个函数在同一个抽象层级**
- _我们想要让代码拥有自顶向下的阅读顺序_，因此让**每个函数后面都跟着下一抽象层级的函数**，此举方便了以后修改代码和阅读代码。

### 函数编写细则
- **一定不要重复自己**，重复的代码**难以修复**，且可读性差，应该把重复的代码写成函数。
- 函数应该只做一件事，**当做了多件事的时候就很容易产生副作用**。
  - 有的时候副作用往往是致命的，因为它的隐蔽性很强，不容易察觉，而又确实造成了影响。
  - 在对函数测试的时候，函数应该剔除所有副作用。

- 函数要么"做什么事"，要么"回答什么事"。即是**将指令和询问分隔开来**。
- 抽离try/catch代码块，他们会搞乱了代码结构，把错误处理和正常流程混为一谈。所以应该把其主体部分抽离出来，另外写成函数。**错误处理的代码应该就是包含它的函数的所有代码**。

### 总结
- 好的函数并不是一开始就能写出来，而是通过**分解函数、修改名称、消除重复**反复打磨而成。我们相信没人能做到一开始就能写出符合这所有的规则的函数。但是厉害的人总能在修改中做到。

## 类
### 类的组织（代码顺序）
尽可能让外部可见的放在前面。变量优先于方法。
  1. 类应该从一组变量列表开始。如果有公共静态常量，应该先出现。然后是私有静态变量，以及私有实体变量。**很少会有公共变量**（尽量可能公共变量的数量）。
  2. 公共函数应跟在变量列表之后，最后再是私有函数。

### 类应该短小
1. **类名应该精确**。类的名称应该描述其全责。
2. **一个类应该只有一个全责**。
3. 内聚。
  - 类应该只有少量实体变量。类中的每个方法都应该操作一个或多个这样的变量。
  - 高的内聚性，意味着类中的方法和变量互相依赖、互相结合成一个逻辑整体。
  - 就像人一样，人暴露出来的属性和方法极少，而人体内的细胞、组织完成了数以万计的功能（当然人作为一个具体的类实在是只有上帝才能编写=，=，世间还没有更复杂的软件）。

4. 将类从大类里面挣扎出来
  - 有时候，随着对方法的扩充，实体变量的数量开始上升，往往这意味着**至少有一个类要从大类里面挣扎出来**。
  - 重构代码后，实体变量就可以分给几个不同的类了，而不是一堆挤在一起。

### 修进类的技巧
> 我们知道编写一个类不是一触而就的，而是通过了无数次修进的。而系统的每处修改（添加功能，改变逻辑方法等）都让我们冒着系统会出现问题的风险。这时候我们要对类加以修进（组织和重构），以降低修改所面临的风险。

1. 当一个类庞杂巨大需要重构的时候，将一个类分隔为几个类，用明确的功能权责来划分。
2. 当有新特性要添加时，可以写一个新类，如果能达到新类只用了原有类的极少数（一个或两个）方法时，就是低耦合度。原有类没有被干扰，新类也相当简洁（只服务于某个新特性）。
